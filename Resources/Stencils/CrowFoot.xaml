<ResourceDictionary xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
                    xmlns:s="clr-namespace:DiagramDesigner"
                    xmlns:c="clr-namespace:DiagramDesigner.Controls">
  <!-- Конвертер для BooleanToVisibility -->
    <BooleanToVisibilityConverter x:Key="BoolToVisibility"/>

    <!-- Crow's Foot Table Style -->
    <Style x:Key="CrowFootTable" TargetType="Path" BasedOn="{StaticResource FlowChartItemStyle}">
        <Setter Property="Data" Value="M 0,0 H 120 V 30 H 0 V 0 M 0,30 H 120 V 120 H 0 V 30"/>
    </Style>

    <Style x:Key="CrowFootTable_DragThumb" TargetType="Path" BasedOn="{StaticResource CrowFootTable}">
        <Setter Property="IsHitTestVisible" Value="true"/>
        <Setter Property="Fill" Value="Transparent"/>
        <Setter Property="Stroke" Value="Transparent"/>
    </Style>

    <!-- Field Item Style -->
    <Style x:Key="TableField" TargetType="Path">
        <Setter Property="Data" Value="M 0,0 H 120 V 25 H 0 Z"/>
        <Setter Property="Fill" Value="{DynamicResource ItemBrush1}"/>
        <Setter Property="Stroke" Value="{DynamicResource ItemStroke1}"/>
    </Style>
 <Style x:Key="TableField_DragThumb" TargetType="Path" BasedOn="{StaticResource TableField}">
        <Setter Property="IsHitTestVisible" Value="true"/>
        <Setter Property="Fill" Value="Transparent"/>
        <Setter Property="Stroke" Value="Transparent"/>
    </Style>
    <Style x:Key="FieldTypeDecorator" TargetType="TextBlock">
        <Setter Property="Text" Value="{Binding Type}"/>
        <Setter Property="Margin" Value="90,0,5,0"/>
        <Setter Property="Foreground" Value="Gray"/>
        <Setter Property="FontSize" Value="10"/>
    </Style>

    <!-- Toolbox для Crow's Foot -->
    <s:Toolbox x:Key="CrowFootStencils" ItemSize="120,120">
        <ItemsControl.Items>
            <Grid>
              <!-- Основной контур таблицы -->
    <Path Style="{StaticResource CrowFootTable}" ToolTip="Database Table">
        <s:DesignerItem.DragThumbTemplate>
            <ControlTemplate>
                <Path Style="{StaticResource CrowFootTable_DragThumb}"/>
            </ControlTemplate>
        </s:DesignerItem.DragThumbTemplate>

        <s:DesignerItem.ConnectorDecoratorTemplate>
            <ControlTemplate>
                <c:RelativePositionPanel Margin="-4">
                    <s:Connector Orientation="Top" c:RelativePositionPanel.RelativePosition="0.5,0"/>
                    <s:Connector Orientation="Left" c:RelativePositionPanel.RelativePosition="0,0.5"/>
                    <s:Connector Orientation="Right" c:RelativePositionPanel.RelativePosition="1,0.5"/>
                    <s:Connector Orientation="Bottom" c:RelativePositionPanel.RelativePosition="0.5,1"/>
                </c:RelativePositionPanel>
            </ControlTemplate>
        </s:DesignerItem.ConnectorDecoratorTemplate>
    </Path>

    <!-- Заголовок таблицы и кнопка добавления поля -->
    <StackPanel Orientation="Horizontal" VerticalAlignment="Top" Margin="5,2,5,0">
        <TextBox Style="{StaticResource Textadapter}" 
                 Text="{Binding TableName}"
                 VerticalAlignment="Center"/>
        <Button Content="+" 
                Command="{Binding AddFieldCommand}"
                Margin="5,0,0,0"
                Width="20"
                Height="20"/>
    </StackPanel>

    <!-- Список полей -->
    <ItemsControl ItemsSource="{Binding Fields}" Margin="0,30,0,0">
        <ItemsControl.ItemTemplate>
            <DataTemplate>
                <Grid>
                    <Path Style="{StaticResource TableField}"/>
                    <TextBox Style="{StaticResource Textadapter}"
                             Margin="5,2"
                             Text="{Binding Name}"
                             VerticalAlignment="Center"/>
                    <TextBlock Style="{StaticResource FieldTypeDecorator}"/>
                    <Path Data="M 5,12 L 15,12 M 10,7 L 10,17"
                          Stroke="Black"
                          Visibility="{Binding IsPrimaryKey, Converter={StaticResource BoolToVisibility}}"
                          Margin="5"/>
                </Grid>
            </DataTemplate>
        </ItemsControl.ItemTemplate>
    </ItemsControl>
            </Grid>
        </ItemsControl.Items>
    </s:Toolbox>
    </ResourceDictionary>